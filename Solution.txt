with daily_transactions AS
(
  select date(transaction_time) as transaction_date, 
  sum(transaction_amount) as total_amount
  from transactions
  group by 1
 ),
 
 rolled as
 (
 select *, 
 avg(total_amount) over(order by transaction_date rows between 2 preceding 		and current row) as rolling_avg
 from daily_transactions
  )
  
  select transaction_date, rolling_avg
  from rolled
  where transaction_date = '2021-01-31'
